data=[0 8;
0.1282 10;
0.2565 11;
0.3847 11.99;
0.5129 11.5;
0.6411 10.489;
0.7694 8.529;
0.8976 6.844;
1.0258 3.83;
1.1541 0.68;
1.2823 -2.24;
1.4105 -5.92;
1.5387 -7.42;
1.667 -9;
1.7952 -11;
1.9234 -11.9615;
2.0517 -11.14;
2.1799 -10;
2.3081 -9;
2.4363 -7;
2.5646 -4;
2.6928 -1;
2.821 1;
2.9493 4.6;
3.0775 7;
3.2057 9;
3.3339 11.0494;
3.4622 11.;
3.5904 11.5;
3.7186 11.37;
3.8468 9.08;
3.9751 7;
4.1033 5;
4.2315 2;
4.3598 -0.9607;
4.488 -3;
4.6162 -6;
4.7444 -9;
4.8727 -10.68;
5.0009 -11.04;
5.1291 -11.61;
5.2574 -11.78;
5.3856 -10.07;
5.5138 -8;
5.642 -5;
5.7703 -2;
5.8985 0.23;
6.0267 3.25;
6.155 6.54;
6.2832 8];

t=data(:,1);
y=data(:,2);
T=3;	% Initial guess of the period
A=[cos(2*pi/T*t), sin(2*pi/T*t)];
theta=A\y;
y2=A*theta;
subplot(3,1,1);
plot(t, y, '.-', t, y2, '.-');
title('Initial guess');

TT=linspace(T-0.2, T+0.2);
for i=1:length(TT)
	A=[cos(2*pi/TT(i)*t), sin(2*pi/TT(i)*t)];
	theta=A\y;
	y2=A*theta;
	rmse(i)=sum((y-y2).^2);
end
subplot(3,1,2);
plot(TT, rmse, '.-');
title('RMSE');
[minRmse, index]=min(rmse);
bestT=TT(index);	% ³Ì¨Îªº¶g´Á
line(TT(index), rmse(index), 'marker', 'o', 'color', 'r');

A=[cos(2*pi/bestT*t), sin(2*pi/bestT*t)];
theta=A\y;
y2=A*theta;
subplot(3,1,3);
plot(t, y, '.-', t, y2, '.-');
title('Best Fit');